# AI-as-Me v3.2 PRD - 灵感池机制

**文档版本**: 1.0  
**创建日期**: 2026-01-15  
**状态**: Draft

---

## 1. 概述

### 1.1 背景
v3.0 Review 报告指出"灵感池"是"AI养蛊"方法论中唯一未实现的核心要素。灵感池让 AI 能够主动收集、孵化和转化想法，实现真正的自主进化。

### 1.2 目标
实现完整的灵感池机制，让 AI 从被动响应升级为主动思考。

---

## 2. 功能需求

### 2.1 灵感捕获 (Inspiration Capture)

**FR-2.1.1**: 从对话中提取灵感
- 识别用户表达的想法、建议、问题
- 关键词触发：`想法`、`或许`、`以后`、`TODO`、`灵感`
- 自动标记来源和时间戳

**FR-2.1.2**: 从任务执行中提取灵感
- 任务失败时记录改进想法
- 任务成功时记录可复用模式
- 关联原始任务 ID

**FR-2.1.3**: 手动添加灵感
- CLI 命令：`ai-as-me inspiration add "想法内容"`
- 支持标签和优先级

### 2.2 灵感存储 (Inspiration Storage)

**FR-2.2.1**: 灵感数据结构
```json
{
  "id": "insp_001",
  "content": "灵感内容",
  "source": "conversation|task|manual",
  "source_id": "关联ID",
  "tags": ["tag1", "tag2"],
  "priority": "low|medium|high",
  "maturity": 0.0-1.0,
  "status": "incubating|mature|converted|archived",
  "created_at": "ISO8601",
  "updated_at": "ISO8601"
}
```

**FR-2.2.2**: 存储位置
- 文件：`soul/inspiration/pool.jsonl`
- 索引：`soul/inspiration/index.json`

### 2.3 灵感孵化 (Inspiration Incubation)

**FR-2.3.1**: 成熟度计算
- 时间因素：存在时间越长，成熟度越高
- 关联因素：被多次提及，成熟度提升
- 验证因素：相关任务成功，成熟度提升

**FR-2.3.2**: 定期回顾
- 每日自动回顾灵感池
- 提升成熟灵感的优先级
- 归档长期未活跃的灵感

### 2.4 灵感转化 (Inspiration Conversion)

**FR-2.4.1**: 转化为规则
- 成熟度 > 0.8 时提示转化
- 调用 Evolution Engine 生成规则
- 记录转化历史

**FR-2.4.2**: 转化为任务
- 用户确认后创建 Kanban 任务
- 关联原始灵感 ID

**FR-2.4.3**: 转化为技能
- 识别可复用的操作模式
- 生成技能定义文件

### 2.5 灵感可视化 (Inspiration Visualization)

**FR-2.5.1**: CLI 命令
- `ai-as-me inspiration list` - 列出灵感
- `ai-as-me inspiration show <id>` - 查看详情
- `ai-as-me inspiration mature` - 列出成熟灵感
- `ai-as-me inspiration convert <id>` - 转化灵感

**FR-2.5.2**: 状态统计
- 灵感总数
- 各状态分布
- 转化率

---

## 3. 非功能需求

### 3.1 性能
- 灵感捕获延迟 < 50ms
- 灵感池查询 < 100ms（1000 条以内）
- 孵化任务不阻塞主流程

### 3.2 可靠性
- 灵感数据持久化
- 崩溃恢复不丢失数据

### 3.3 可扩展性
- 支持自定义灵感来源
- 支持自定义成熟度算法

---

## 4. 用户故事

### US-4.1: 对话灵感捕获
**作为**用户  
**我想要**AI 自动记住我在对话中提到的想法  
**以便**以后可以回顾和执行

**验收标准**:
- 当我说"以后可以..."时，AI 自动记录灵感
- 灵感包含完整上下文
- 可以通过 CLI 查看

### US-4.2: 灵感成熟提醒
**作为**用户  
**我想要**AI 提醒我哪些灵感已经成熟  
**以便**我可以决定是否转化

**验收标准**:
- 成熟度 > 0.8 时显示提醒
- 提醒包含灵感摘要
- 可以一键转化或延后

### US-4.3: 灵感转化为规则
**作为**用户  
**我想要**将成熟的灵感转化为 Soul 规则  
**以便**AI 能够学习这个想法

**验收标准**:
- 转化命令简单直观
- 生成的规则符合规范
- 保留灵感到规则的关联

---

## 5. 技术设计要点

### 5.1 模块结构
```
src/ai_as_me/inspiration/
├── __init__.py
├── capturer.py      # 灵感捕获
├── pool.py          # 灵感池管理
├── incubator.py     # 灵感孵化
└── converter.py     # 灵感转化
```

### 5.2 集成点
- **Agent**: 对话时调用 Capturer
- **Evolution Engine**: 转化时调用 Generator
- **Kanban**: 转化为任务时调用 API
- **CLI**: 新增 inspiration 命令组

---

## 6. 里程碑

| 阶段 | 内容 | 预计时间 |
|------|------|----------|
| M1 | 灵感捕获 + 存储 | 2 天 |
| M2 | 灵感孵化 | 1 天 |
| M3 | 灵感转化 | 2 天 |
| M4 | CLI + 测试 | 1 天 |

---

## 7. 风险

| 风险 | 缓解措施 |
|------|----------|
| 灵感识别准确率低 | 用户确认机制 + 关键词白名单 |
| 灵感池膨胀 | 自动归档 + 容量限制 |
| 转化质量不稳定 | 人工审核 + 回滚能力 |

---

**下一步**: 创建 v3.2 Architecture
